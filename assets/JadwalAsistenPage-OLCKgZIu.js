import{r as i,u as F,j as e}from"./index-D7BPkl7L.js";import{a as C}from"./index-xsH4HHeE.js";import{L as x}from"./Layout-CvxaU38W.js";import{g as L,m as E,r as u,s as p,j as g,a as N,l as f}from"./proxy-CFRt1oNv.js";function U(){const[c,y]=i.useState([]),[w,v]=i.useState([]),[b,n]=i.useState(!1),[m,o]=i.useState(null),[r,k]=i.useState(null),d=F();i.useEffect(()=>{const s=localStorage.getItem("token");if(s)try{const a=JSON.parse(atob(s.split(".")[1]));k({id:a.user_id,...a})}catch(a){console.error("Token parsing error:",a),d("/login")}else d("/login")},[d]),i.useEffect(()=>{if(!(r!=null&&r.user_id))return;(async()=>{var a,t;try{n(!0),o(null);const j=(await C.get("http://localhost:8080/api/asisten-kelas",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}})).data;v(j);const _=j.filter(A=>A.asisten_id===Number(r.user_id));y(_)}catch(l){console.error("Fetch error:",l),o(((t=(a=l.response)==null?void 0:a.data)==null?void 0:t.error)||l.message||"Failed to load schedules")}finally{n(!1)}})()},[r==null?void 0:r.id]);const S=({item:s})=>{const a=h(s.jadwal_id);return e.jsxs("div",{className:"border-b border-gray-200 p-4 md:p-6",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(u,{className:"text-blue-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm md:text-base font-medium text-gray-900 truncate",children:s.jadwal.mata_kuliah.nama}),e.jsx("div",{className:"text-xs text-gray-500",children:s.jadwal.mata_kuliah.kode})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Hari/Jam"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(p,{className:"text-gray-400 mr-2 text-sm"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.jadwal.hari}),e.jsxs("div",{className:"text-xs text-gray-500 flex items-center",children:[e.jsx(g,{className:"mr-1"}),s.jadwal.jam_mulai," - ",s.jadwal.jam_selesai]})]})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Kelas/Lab"}),e.jsxs("div",{className:"mt-1",children:[e.jsx("div",{className:"text-sm text-gray-900",children:s.jadwal.kelas}),e.jsx("div",{className:"text-xs text-gray-500",children:s.jadwal.lab})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Dosen"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(N,{className:"text-gray-400 mr-2 text-sm"}),e.jsx("div",{className:"text-sm text-gray-900",children:s.jadwal.dosen.nama})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Asisten"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(f,{className:"text-gray-400 mr-2 text-sm"}),e.jsx("div",{children:a.map((t,l)=>e.jsx("div",{className:"text-sm text-gray-900",children:t},l))})]})]})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:["Semester ",s.jadwal.semester]})})]})},h=s=>{const a=w.filter(t=>t.jadwal_id===s).map(t=>t.user.nama);return a.length===1?[a[0],"-"]:a.slice(0,2)};return b?e.jsx(x,{children:e.jsx("main",{className:"flex-1 p-4 md:p-6 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Memuat data jadwal..."})]})})}):m?e.jsx(x,{children:e.jsx("main",{className:"flex-1 p-4 md:p-6 flex items-center justify-center",children:e.jsxs("div",{className:"text-center text-red-500 max-w-md",children:[e.jsx(L,{className:"mx-auto h-12 w-12 mb-4"}),e.jsxs("p",{className:"mb-4",children:["Gagal memuat data: ",m]}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm md:text-base",children:"Coba Lagi"})]})})}):e.jsx(x,{children:e.jsx(E.main,{className:"flex-1 p-4 sm:p-6 overflow-x-hidden max-w-7xl mx-auto overflow-y-auto",style:{maxHeight:"600px"},initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:c.length===0?e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm text-center",children:[e.jsx("p",{className:"text-gray-500 mb-4",children:"Anda belum mengambil jadwal sebagai asisten."}),e.jsx("button",{onClick:()=>d("/mata-kuliah"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm md:text-base",children:"Ambil Jadwal Sekarang"})]}):e.jsxs("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:[e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mata Kuliah"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Hari/Jam"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Kelas/Lab"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Dosen"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Asisten"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Semester"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.map(s=>{const a=h(s.jadwal_id);return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(u,{className:"text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.jadwal.mata_kuliah.nama}),e.jsx("div",{className:"text-sm text-gray-500",children:s.jadwal.mata_kuliah.kode})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(p,{className:"text-gray-400 mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.jadwal.hari}),e.jsxs("div",{className:"text-sm text-gray-500 flex items-center",children:[e.jsx(g,{className:"mr-1"}),s.jadwal.jam_mulai," - ",s.jadwal.jam_selesai]})]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:s.jadwal.kelas}),e.jsx("div",{className:"text-sm text-gray-500",children:s.jadwal.lab})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(N,{className:"text-gray-400 mr-2"}),e.jsx("div",{className:"text-sm text-gray-900",children:s.jadwal.dosen.nama})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(f,{className:"text-gray-400 mr-2"}),e.jsx("div",{children:a.map((t,l)=>e.jsx("div",{className:"text-sm text-gray-900",children:t},l))})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:["Semester ",s.jadwal.semester]})})]},s.id)})})]})}),e.jsx("div",{className:"md:hidden",children:c.map(s=>e.jsx(S,{item:s},s.id))})]})})})}export{U as default};
