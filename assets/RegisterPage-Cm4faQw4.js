import{u as C,r as o,j as e,L as $}from"./index-D7BPkl7L.js";import{a as E}from"./index-xsH4HHeE.js";import{m as d,F as j,a as F,b as L,c as A,d as R,e as y,f as I}from"./proxy-CFRt1oNv.js";const B=()=>{const x=C(),[s,w]=o.useState({nama:"",email:"",password:"",confirmPassword:"",telepon:"",nim:""}),[a,c]=o.useState({}),[m,p]=o.useState(!1),[f,h]=o.useState(""),[g,u]=o.useState(!1),[n,b]=o.useState(1),l=r=>{const{name:t,value:i}=r.target;w({...s,[t]:i}),a[t]&&c({...a,[t]:null})},N=()=>{const r={};return s.nama.trim()||(r.nama="Nama lengkap wajib diisi"),s.nim.trim()||(r.nim="NIM wajib diisi"),s.email.trim()?/^\S+@\S+\.\S+$/.test(s.email)||(r.email="Email tidak valid"):r.email="Email wajib diisi",c(r),Object.keys(r).length===0},v=()=>{const r={};return s.telepon.trim()?/^[0-9]+$/.test(s.telepon)?(s.telepon.length<10||s.telepon.length>13)&&(r.telepon="Nomor telepon harus 10-13 digit"):r.telepon="Nomor telepon harus angka":r.telepon="Nomor telepon wajib diisi",s.password?s.password.length<6&&(r.password="Password minimal 6 karakter"):r.password="Password wajib diisi",s.password!==s.confirmPassword&&(r.confirmPassword="Password tidak cocok"),c(r),Object.keys(r).length===0},k=()=>{N()&&b(2)},S=()=>{b(1)},M=async r=>{if(r.preventDefault(),h(""),!!v()){p(!0);try{const t=await E.post("http://localhost:8080/api/register",{nama:s.nama,email:s.email,password:s.password,telepon:s.telepon,nim:s.nim,role:"asisten"});if(console.log("API Response:",t.data),t.data&&(t.data.success||t.data.message))u(!0),console.log("Registration success, modal should appear");else throw new Error("Format response tidak dikenali")}catch(t){console.error("Registration error:",t);let i="Terjadi kesalahan saat pendaftaran";t.response?(t.response.data&&(t.response.data.error?i=t.response.data.error:t.response.data.message&&(i=t.response.data.message)),t.response.status===400?i=i||"Data yang dimasukkan tidak valid":t.response.status===409&&(i=i||"Email atau NIM sudah terdaftar")):t.message&&(i=t.message),h(i)}finally{p(!1)}}};g&&(d.div,j);const P=()=>{u(!1),x("/")};return e.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-4",children:[g&&e.jsx("div",{className:"fixed inset-0 drop-shadow-2xl bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsx(d.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 mb-4",children:e.jsx(j,{className:"h-6 w-6 text-green-600"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Pendaftaran Berhasil!"}),e.jsx("div",{className:"mt-2",children:e.jsx("p",{className:"text-sm text-gray-500",children:"Akun telah berhasil dibuat. Mohon konfirmasi ke administrator untuk aktivasi akun."})}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{type:"button",onClick:P,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Kembali ke Halaman Login"})})]})})}),e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white p-6 sm:p-8 rounded-lg shadow-md max-w-md w-full",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Daftar Akun Baru"}),e.jsxs("p",{className:"text-gray-600 mt-2",children:["Langkah ",n," dari 2 - Isi data berikut"]}),e.jsx("div",{className:"flex justify-center mt-4 mb-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${n===1?"bg-blue-600 text-white":"bg-gray-200 text-gray-600"}`,children:"1"}),e.jsx("div",{className:`w-16 h-1 mx-1 ${n===2?"bg-blue-600":"bg-gray-200"}`}),e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${n===2?"bg-blue-600 text-white":"bg-gray-200 text-gray-600"}`,children:"2"})]})})]}),f&&e.jsx("div",{className:"mb-4 p-3 bg-red-100 border-l-4 border-red-500 text-red-700 rounded",children:e.jsx("p",{children:f})}),e.jsxs("form",{onSubmit:M,className:"space-y-4",children:[n===1&&e.jsxs(d.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.3},children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Lengkap"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(F,{className:"text-gray-400"})}),e.jsx("input",{type:"text",name:"nama",className:`pl-10 w-full p-3 border ${a.nama?"border-red-500":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition`,placeholder:"Masukkan nama lengkap",value:s.nama,onChange:l})]}),a.nama&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.nama})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"NIM"}),e.jsx("input",{type:"text",name:"nim",className:`w-full p-3 border ${a.nim?"border-red-500":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition`,placeholder:"Masukkan NIM",value:s.nim,onChange:l}),a.nim&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.nim})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(L,{className:"text-gray-400"})}),e.jsx("input",{type:"email",name:"email",className:`pl-10 w-full p-3 border ${a.email?"border-red-500":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition`,placeholder:"Masukkan email",value:s.email,onChange:l})]}),a.email&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.email})]}),e.jsx("div",{className:"pt-4",children:e.jsxs("button",{type:"button",onClick:k,className:"w-full flex justify-center items-center py-3 px-4 bg-gradient-to-r from-blue-600 to-indigo-700 hover:from-blue-700 hover:to-indigo-800 text-white font-medium rounded-lg transition-colors",children:["Lanjut ke Langkah 2",e.jsx(A,{className:"ml-2"})]})})]}),n===2&&e.jsxs(d.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nomor Telepon"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(R,{className:"text-gray-400"})}),e.jsx("input",{type:"text",name:"telepon",className:`pl-10 w-full p-3 border ${a.telepon?"border-red-500":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition`,placeholder:"Masukkan nomor telepon",value:s.telepon,onChange:l})]}),a.telepon&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.telepon})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(y,{className:"text-gray-400"})}),e.jsx("input",{type:"password",name:"password",className:`pl-10 w-full p-3 border ${a.password?"border-red-500":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition`,placeholder:"Masukkan password",value:s.password,onChange:l})]}),a.password&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.password})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Konfirmasi Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(y,{className:"text-gray-400"})}),e.jsx("input",{type:"password",name:"confirmPassword",className:`pl-10 w-full p-3 border ${a.confirmPassword?"border-red-500":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition`,placeholder:"Masukkan ulang password",value:s.confirmPassword,onChange:l})]}),a.confirmPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.confirmPassword})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsxs("button",{type:"button",onClick:S,className:"flex-1 flex justify-center items-center py-3 px-4 bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium rounded-lg transition-colors",children:[e.jsx(I,{className:"mr-2"}),"Kembali"]}),e.jsx("button",{type:"submit",disabled:m,className:`flex-1 flex justify-center items-center py-3 px-4 bg-gradient-to-r from-blue-600 to-indigo-700 hover:from-blue-700 hover:to-indigo-800 text-white font-medium rounded-lg transition-colors ${m?"opacity-75 cursor-not-allowed":""}`,children:m?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Memproses..."]}):"Daftar Sekarang"})]})]})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-gray-600",children:["Sudah punya akun?"," ",e.jsx($,{to:"/",className:"text-blue-600 hover:text-blue-800 font-medium",children:"Masuk di sini"})]})})]})]})};export{B as default};
