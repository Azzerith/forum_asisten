import{r,j as e}from"./index-D7BPkl7L.js";import{a as j}from"./index-xsH4HHeE.js";import{L as I,A as D}from"./Layout-CvxaU38W.js";import{m as x,C as M,o as z,w as H,n as R,x as q,D as W,E as X}from"./proxy-CFRt1oNv.js";function Q(){const[d,g]=r.useState([]),[v,c]=r.useState([]),[T,w]=r.useState(!0),[S,b]=r.useState(null),[n,k]=r.useState(null),[m,f]=r.useState({nama:""}),[l,u]=r.useState(!1),[C,E]=r.useState(null),[o,F]=r.useState(""),N=localStorage.getItem("token"),y=()=>({Authorization:`Bearer ${N}`,"Content-Type":"application/json"});r.useEffect(()=>{(async()=>{var s,i;if(N)try{w(!0),b(null);const t=await j.get("http://localhost:8080/api/admin/program-studi",{headers:y()});g(t.data||[]),c(t.data||[])}catch(t){b(((i=(s=t.response)==null?void 0:s.data)==null?void 0:i.message)||t.message||"Gagal mengambil data")}finally{w(!1)}})()},[N]),r.useEffect(()=>{if(o.trim()==="")c(d);else{const a=d.filter(s=>s.nama.toLowerCase().includes(o.toLowerCase())||s.id.toString().includes(o));c(a)}},[o,d]);const L=async a=>{var s,i;if(window.confirm("Yakin ingin menghapus data Program Studi ini?"))try{u(!0),await j.delete(`http://localhost:8080/api/admin/program-studi/${a}`,{headers:y()});const t=d.filter(p=>p.id!==a);g(t),c(t),P("Program Studi berhasil dihapus")}catch(t){h(`Gagal menghapus Program Studi: ${((i=(s=t.response)==null?void 0:s.data)==null?void 0:i.message)||t.message}`)}finally{u(!1)}},A=a=>{k(a.id),f({nama:a.nama||""})},$=()=>{k(null),f({nama:""})},B=async a=>{var s,i;if(a.preventDefault(),!m.nama.trim()){h("Nama Program Studi harus diisi");return}try{u(!0),await j.put(`http://localhost:8080/api/admin/program-studi/${n}`,m,{headers:y()});const t=d.map(p=>p.id===n?{...p,...m}:p);g(t),c(t),$(),P("Prodi berhasil diupdate")}catch(t){h(`Gagal mengupdate Prodi: ${((i=(s=t.response)==null?void 0:s.data)==null?void 0:i.message)||t.message}`)}finally{u(!1)}},G=async()=>{var a,s;if(!m.nama.trim()){h("Nama Program Studi harus diisi");return}try{u(!0);const i=await j.post("http://localhost:8080/api/admin/program-studi",m,{headers:y()}),t=[...d,i.data];g(t),c(t),f({nama:""}),P("Program Studi berhasil ditambahkan")}catch(i){h(`Gagal menambah Program Studi: ${((s=(a=i.response)==null?void 0:a.data)==null?void 0:s.message)||i.message}`)}finally{u(!1)}},P=a=>{E(a),setTimeout(()=>E(null),3e3)},h=a=>{b(a),setTimeout(()=>b(null),5e3)};return e.jsx(I,{children:e.jsx("main",{className:"flex-1 p-6 overflow-auto",children:e.jsxs(x.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.4},className:"max-w-4xl mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold text-blue-900 mb-6",children:"Data Program Studi"}),e.jsxs(D,{children:[S&&e.jsx(x.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0},className:"mb-4 p-4 bg-red-100 border-l-4 border-red-500 text-red-700 rounded",children:e.jsx("p",{children:S})}),C&&e.jsx(x.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0},className:"mb-4 p-4 bg-green-100 border-l-4 border-green-500 text-green-700 rounded",children:e.jsx("p",{children:C})})]}),e.jsxs(x.div,{className:"bg-white p-6 rounded-xl shadow-md mb-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:n?"Edit Program Studi":"Tambah Program Studi Baru"}),e.jsxs("form",{onSubmit:n?B:a=>{a.preventDefault(),G()},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"nama",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Program Studi"}),e.jsx("input",{id:"nama",type:"text",placeholder:"Masukkan nama Prodi",className:"text-black w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",value:m.nama,onChange:a=>f({nama:a.target.value}),disabled:l,required:!0})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{type:"submit",className:`flex items-center justify-center px-5 py-2.5 rounded-lg ${n?"bg-indigo-600 hover:bg-indigo-700":"bg-blue-600 hover:bg-blue-700"} text-white transition-colors ${l?"opacity-70 cursor-not-allowed":""}`,disabled:l,children:l?e.jsx(M,{className:"animate-spin mr-2"}):n?e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"mr-2"}),"Simpan Perubahan"]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"mr-2"}),"Tambah Program Studi"]})}),n&&e.jsxs("button",{type:"button",onClick:$,className:"flex items-center justify-center px-5 py-2.5 bg-gray-200 hover:bg-gray-300 text-white rounded-lg transition-colors",disabled:l,children:[e.jsx(R,{className:"mr-2"}),"Batal"]})]})]})]}),e.jsxs(x.div,{className:"bg-white p-6 rounded-xl shadow-md",initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Daftar Prodi"}),e.jsxs("div",{className:"flex items-center gap-3 w-full sm:w-auto",children:[e.jsxs("span",{className:"bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full whitespace-nowrap",children:[v.length," Program Studi"]}),e.jsxs("div",{className:"relative w-full sm:w-64",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(q,{className:"text-gray-400"})}),e.jsx("input",{type:"text",placeholder:"Cari Prodi...",className:" text-black block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",value:o,onChange:a=>F(a.target.value)})]})]})]}),T?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-blue-500"})}):v.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-gray-400 mb-2",children:e.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),e.jsx("p",{className:"text-gray-500",children:o?"Tidak ditemukan Prodi yang sesuai":"Belum ada data Prodi."}),o&&e.jsx("button",{onClick:()=>F(""),className:"mt-2 text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Reset pencarian"})]}):e.jsx("div",{className:"divide-y divide-gray-200 overflow-y-auto",style:{maxHeight:"200px"},children:e.jsx(D,{children:v.map(a=>e.jsxs(x.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0},transition:{duration:.2},className:"text-black py-4 flex justify-between items-center hover:bg-gray-50 px-3 rounded-lg transition-colors",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-800",children:a.nama||"-"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["ID: ",a.id]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>A(a),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-full transition-colors",title:"Edit",disabled:l,children:e.jsx(W,{size:18})}),e.jsx("button",{onClick:()=>L(a.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-full transition-colors",title:"Hapus",disabled:l,children:e.jsx(X,{size:18})})]})]},a.id))})})]})]})})})}export{Q as default};
